# Web Application for Interaction with Clients

В данном проекте были имлементированы следующие пункты:
- Создание модели участника и добавление проверки на уникальности поля почты (используется UniqueConstraint)
- Эндпоинт для регистрации новых участников на JWT токенах и обработки их авторок вотермаркой с помощью функции, запускающейся в асинхронном потоке при её жвызове
- Эндпоинт для просталения участниками взаимной симпатии друг другу (реакций/метчей) с отправкой сообщений на почту при возникновения метча и обработки ежедневного лимита действия
- Эндпоинт для получения всех клиентов с фильтрами по имени, фамилии, полу и дате регистрации ("начиная с", "до", по возрастанию/по убыванию)
- Добавление полей долготы и широты в модель Client и фильтра на расстояние, высчитываемого по формуле Great-Circle Distance и использующего кэширование
- Тест конфигурации базы данных

# Запуск проекта
Сконфигурируйте файл `.env`, как показано в `.env-example`, по умолчанию название, юзер и пароль от базы данных - `postgres` (сам хост - db, то есть название контейнера в докере). Нужно обязательно заполнить поле `JWT_SECRET`, которое отвечает за логику авторизации на токенах.
## Используя Docker Compose
Пропишите команду в корне репозитория, чтобы создать образы базы данных, накатить на неё миграции и запустить API:
```.sh
docker-compose -f docker-compose.yaml build
```
Чтобы запустить образы пропишите:
```.sh
docker-compose -f docker-compose.yaml up
```
*если произошла ошибка при накате миграций, то пропишите команду еще раз*
## Мануальный запуск
*Пререквезит: иметь установленным PostgreSQL; поменять в config.py `DATABASE_HOST` на `localhost`*
```.sh
python -m pip install pipenv
python -m pipenv shell
pip install pipenv
pipenv sync
export PYTHONPATH=$PYTHONPATH:$(pwd)
alembic upgrade head
python api/main.py
```



